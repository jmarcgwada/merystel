{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the Zenith POS system.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the user." },
        "firstName": { "type": "string", "description": "The first name of the user." },
        "lastName": { "type": "string", "description": "The last name of the user." },
        "email": { "type": "string", "description": "The email address of the user.", "format": "email" },
        "phone": { "type": "string", "description": "The phone number of the user." },
        "companyId": { "type": "string", "description": "Reference to the Company the user belongs to." },
        "isDisabled": { "type": "boolean", "description": "Whether the user account is disabled." },
        "sessionDuration": { "type": "number", "description": "Session duration in minutes. 0 for unlimited." }
      },
      "required": ["id", "firstName", "lastName", "email", "companyId"]
    },
    "Company": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Company",
      "type": "object",
      "description": "Represents a company using the Zenith POS system. This is the root for all company-specific data.",
      "properties": {
        "name": { "type": "string", "description": "The name of the company." },
        "address": { "type": "string", "description": "The physical address of the company." },
        "postalCode": { "type": "string" },
        "city": { "type": "string" },
        "region": { "type": "string" },
        "country": { "type": "string" },
        "email": { "type": "string", "format": "email" },
        "phone": { "type": "string" },
        "website": { "type": "string" },
        "siret": { "type": "string" },
        "legalForm": { "type": "string" },
        "iban": { "type": "string" },
        "bic": { "type": "string" },
        "notes": { "type": "string", "description": "Footer notes for printed documents." },
        "internalNotes": { "type": "string", "description": "Internal notes for the company." },
        "ticketCounter": { "type": "number", "description": "Counter for ticket numbers." },
        "invoiceCounter": { "type": "number", "description": "Counter for invoice numbers." },
        "quoteCounter": { "type": "number", "description": "Counter for quote numbers." },
        "deliveryNoteCounter": { "type": "number", "description": "Counter for delivery note numbers." },
        "creditNoteCounter": { "type": "number", "description": "Counter for credit note numbers." },
        "supplierOrderCounter": { "type": "number", "description": "Counter for supplier order numbers." }
      },
      "required": ["name", "address", "postalCode", "city", "country", "email"]
    },
    "Customer": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Customer",
      "type": "object",
      "description": "Represents a customer of the company.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the customer." },
        "name": { "type": "string", "description": "The full name of the customer." },
        "email": { "type": "string", "description": "The email address of the customer.", "format": "email" },
        "phone": { "type": "string", "description": "The phone number of the customer." },
        "phone2": { "type": "string", "description": "The second phone number of the customer." },
        "isDefault": { "type": "boolean", "description": "Whether this is the default customer for new sales." },
        "address": { "type": "string" },
        "postalCode": { "type": "string" },
        "city": { "type": "string" },
        "country": { "type": "string" },
        "iban": { "type": "string" },
        "notes": { "type": "string" },
        "isDisabled": { "type": "boolean", "description": "Whether the customer is disabled." }
      },
      "required": ["id", "name"]
    },
    "Supplier": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Supplier",
      "type": "object",
      "description": "Represents a supplier for the company.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the supplier." },
        "name": { "type": "string", "description": "The name of the supplier." },
        "contactName": { "type": "string", "description": "The name of the contact person." },
        "email": { "type": "string", "description": "The email address of the supplier.", "format": "email" },
        "phone": { "type": "string", "description": "The phone number of the supplier." },
        "address": { "type": "string" },
        "postalCode": { "type": "string" },
        "city": { "type": "string" },
        "country": { "type": "string" },
        "siret": { "type": "string" },
        "notes": { "type": "string" },
        "website": { "type": "string" },
        "iban": { "type": "string" },
        "bic": { "type": "string" }
      },
      "required": ["id", "name"]
    },
    "Category": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Category",
      "type": "object",
      "description": "Represents an item category.",
      "properties": {
        "name": { "type": "string" },
        "code": { "type": "string" },
        "color": { "type": "string" },
        "image": { "type": "string" },
        "isFavorite": { "type": "boolean" },
        "isRestaurantOnly": { "type": "boolean" }
      },
      "required": ["name"]
    },
    "Item": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Item",
      "type": "object",
      "description": "Represents a product or service that can be sold.",
      "properties": {
        "name": { "type": "string" },
        "price": { "type": "number" },
        "purchasePrice": { "type": "number", "description": "The cost of acquiring the item." },
        "categoryId": { "type": "string" },
        "supplierId": { "type": "string", "description": "The ID of the item's supplier." },
        "vatId": { "type": "string" },
        "image": { "type": "string" },
        "isFavorite": { "type": "boolean" },
        "description": { "type": "string" },
        "description2": { "type": "string" },
        "showImage": { "type": "boolean" },
        "barcode": { "type": "string" },
        "marginPercentage": { "type": "number", "description": "The profit margin as a percentage of the purchase price." },
        "requiresSerialNumber": { "type": "boolean" },
        "additionalCosts": { "type": "number", "description": "Additional costs as a percentage of the purchase price." },
        "manageStock": { "type": "boolean" },
        "stock": { "type": "number" },
        "lowStockThreshold": { "type": "number" },
        "isDisabled": { "type": "boolean", "description": "Whether the item is disabled and cannot be sold." }
      },
      "required": ["name", "price", "vatId", "barcode"]
    },
    "Table": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Table",
      "type": "object",
      "description": "Represents a table in a restaurant setting.",
      "properties": {
        "name": { "type": "string" },
        "number": { "type": "number" },
        "description": { "type": "string" },
        "status": { "type": "string", "enum": ["available", "occupied", "paying"] },
        "order": { "type": "array", "items": { "type": "object" } },
        "covers": { "type": "number", "description": "Number of seats at the table." },
        "lockedBy": { "type": "string", "description": "ID of the user who locked the table." },
        "occupiedByUserId": { "type": "string" },
        "occupiedAt": { "type": "string", "format": "date-time" },
        "closedByUserId": { "type": "string" },
        "closedAt": { "type": "string", "format": "date-time" }
      },
      "required": ["name", "number", "status", "order"]
    },
    "Sale": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Sale",
      "type": "object",
      "description": "Represents a completed sale transaction, which can be a ticket or an invoice.",
      "properties": {
        "ticketNumber": { "type": "string" },
        "date": { "type": "string", "format": "date-time" },
        "items": { "type": "array", "items": { "type": "object" } },
        "subtotal": { "type": "number" },
        "tax": { "type": "number" },
        "total": { "type": "number" },
        "payments": { "type": "array", "items": { "type": "object" } },
        "customerId": { "type": "string" },
        "tableId": { "type": "string" },
        "tableName": { "type": "string" },
        "status": { "type": "string", "enum": ["paid", "pending", "quote", "delivery_note", "credit_note"] },
        "notes": { "type": "string", "description": "Notes spécifiques à cette pièce." },
        "isRecurring": { "type": "boolean", "description": "Indicates if this sale is a template for recurring invoices." },
        "dunningLevel": { "type": "number", "description": "The current dunning level for an unpaid invoice." },
        "lastDunningDate": { "type": "string", "format": "date-time", "description": "The date of the last dunning action." },
        "recurrence": {
            "type": "object",
            "properties": {
                "frequency": { "type": "string", "enum": ["daily", "weekly", "monthly", "yearly"] },
                "nextDueDate": { "type": "string", "format": "date-time" },
                "lastGeneratedDate": { "type": "string", "format": "date-time" },
                "isActive": { "type": "boolean" }
            }
        }
      },
      "required": ["ticketNumber", "date", "items", "subtotal", "tax", "total", "status"]
    },
    "PaymentMethod": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "PaymentMethod",
      "type": "object",
      "description": "Defines a method of payment.",
      "properties": {
        "name": { "type": "string" },
        "icon": { "type": "string", "enum": ["card", "cash", "check", "other"] },
        "type": { "type": "string", "enum": ["direct", "indirect"] },
        "value": { "type": "number" }
      },
      "required": ["name", "type"]
    },
    "VatRate": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "VatRate",
      "type": "object",
      "description": "Defines a Value Added Tax rate.",
      "properties": {
        "name": { "type": "string" },
        "rate": { "type": "number" },
        "code": { "type": "number" }
      },
      "required": ["name", "rate", "code"]
    },
    "HeldOrder": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "HeldOrder",
      "type": "object",
      "description": "Represents a temporarily saved order.",
      "properties": {
        "date": { "type": "string", "format": "date-time" },
        "items": { "type": "array", "items": { "type": "object" } },
        "total": { "type": "number" },
        "tableName": { "type": "string" },
        "tableId": { "type": "string" }
      },
      "required": ["date", "items", "total"]
    },
    "AuditLog": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "AuditLog",
        "type": "object",
        "description": "Represents a log entry for a significant operation.",
        "properties": {
            "date": { "type": "string", "format": "date-time" },
            "userId": { "type": "string" },
            "userName": { "type": "string" },
            "action": { "type": "string", "enum": ["create", "update", "delete", "transform"] },
            "documentType": { "type": "string" },
            "documentId": { "type": "string" },
            "documentNumber": { "type": "string" },
            "details": { "type": "string" }
        },
        "required": ["date", "userId", "userName", "action", "documentType", "documentId", "documentNumber", "details"]
    },
    "DunningLog": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "DunningLog",
        "type": "object",
        "description": "Represents a log entry for a dunning action.",
        "properties": {
            "date": { "type": "string", "format": "date-time" },
            "saleId": { "type": "string" },
            "actionType": { "type": "string", "enum": ["email", "phone", "whatsapp"] },
            "notes": { "type": "string" },
            "status": { "type": "string", "enum": ["sent", "completed", "failed"] }
        },
        "required": ["date", "saleId", "actionType", "status"]
    },
    "Cheque": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Cheque",
      "type": "object",
      "description": "Represents a post-dated check held in portfolio.",
      "properties": {
        "id": { "type": "string" },
        "numeroCheque": { "type": "string" },
        "banque": { "type": "string" },
        "montant": { "type": "number" },
        "dateEcheance": { "type": "string", "format": "date-time" },
        "statut": { "type": "string", "enum": ["enPortefeuille", "remisEnBanque", "encaisse", "impaye", "annule"] },
        "factureId": { "type": "string" },
        "clientId": { "type": "string" },
        "scanUrl": { "type": "string" },
        "notes": { "type": "string" }
      },
      "required": ["id", "numeroCheque", "montant", "dateEcheance", "statut", "factureId", "clientId"]
    },
    "PaiementPartiel": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "PaiementPartiel",
        "type": "object",
        "description": "Represents a partial settlement of an unpaid check.",
        "properties": {
            "id": { "type": "string" },
            "chequeId": { "type": "string" },
            "montant": { "type": "number" },
            "moyenDePaiement": { "type": "string" },
            "datePaiement": { "type": "string", "format": "date-time" }
        },
        "required": ["id", "chequeId", "montant", "moyenDePaiement", "datePaiement"]
    },
    "RemiseCheque": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "RemiseCheque",
        "type": "object",
        "description": "Represents a bank deposit slip for multiple checks.",
        "properties": {
            "id": { "type": "string" },
            "dateRemise": { "type": "string", "format": "date-time" },
            "chequeIds": { "type": "array", "items": { "type": "string" } },
            "montantTotal": { "type": "number" }
        },
        "required": ["id", "dateRemise", "chequeIds", "montantTotal"]
    },
    "SupportTicket": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "SupportTicket",
      "type": "object",
      "description": "Represents a support ticket for service or repair.",
      "properties": {
        "id": { "type": "string" },
        "ticketNumber": { "type": "string" },
        "createdAt": { "type": "string", "format": "date-time" },
        "customerId": { "type": "string" },
        "customerName": { "type": "string" },
        "equipmentType": { "type": "string" },
        "equipmentBrand": { "type": "string" },
        "equipmentModel": { "type": "string" },
        "issueDescription": { "type": "string" },
        "notes": { "type": "string" },
        "status": { "type": "string", "enum": ["Ouvert", "En cours", "En attente de pièces", "Terminé", "Facturé", "Annulé"] }
      },
      "required": ["id", "ticketNumber", "createdAt", "customerId", "equipmentType", "issueDescription", "status"]
    }
  },
  "auth": {
    "providers": ["password", "anonymous"]
  },
  "firestore": {
    "/users/{userId}": {
      "schema": { "$ref": "#/entities/User" },
      "description": "Stores user profile information."
    },
    "/companies/{companyId}": {
      "schema": { "$ref": "#/entities/Company" },
      "description": "Stores root information for a company."
    },
    "/companies/{companyId}/customers/{customerId}": {
      "schema": { "$ref": "#/entities/Customer" },
      "description": "Stores customer data for a specific company."
    },
    "/companies/{companyId}/suppliers/{supplierId}": {
      "schema": { "$ref": "#/entities/Supplier" },
      "description": "Stores supplier data for a specific company."
    },
    "/companies/{companyId}/categories/{categoryId}": {
      "schema": { "$ref": "#/entities/Category" },
      "description": "Item categories for a company."
    },
    "/companies/{companyId}/items/{itemId}": {
      "schema": { "$ref": "#/entities/Item" },
      "description": "All sellable items for a company."
    },
    "/companies/{companyId}/tables/{tableId}": {
      "schema": { "$ref": "#/entities/Table" },
      "description": "Restaurant tables for a company."
    },
    "/companies/{companyId}/sales/{saleId}": {
      "schema": { "$ref": "#/entities/Sale" },
      "description": "Record of all completed sales, invoices, quotes, and delivery notes."
    },
    "/companies/{companyId}/paymentMethods/{methodId}": {
      "schema": { "$ref": "#/entities/PaymentMethod" },
      "description": "Payment methods configured for a company."
    },
    "/companies/{companyId}/vatRates/{vatId}": {
      "schema": { "$ref": "#/entities/VatRate" },
      "description": "VAT rates configured for a company."
    },
    "/companies/{companyId}/heldOrders/{orderId}": {
      "schema": { "$ref": "#/entities/HeldOrder" },
      "description": "Temporarily held orders for a company."
    },
    "/companies/{companyId}/auditLogs/{logId}": {
        "schema": { "$ref": "#/entities/AuditLog" },
        "description": "Audit trail of major operations."
    },
    "/companies/{companyId}/dunning/{dunningId}": {
      "schema": { "$ref": "#/entities/DunningLog" },
      "description": "Log of dunning actions for unpaid invoices."
    },
    "/companies/{companyId}/cheques/{chequeId}": {
      "schema": { "$ref": "#/entities/Cheque" },
      "description": "Portfolio of post-dated checks."
    },
    "/companies/{companyId}/paiementsPartiels/{paiementId}": {
      "schema": { "$ref": "#/entities/PaiementPartiel" },
      "description": "Partial settlements for unpaid checks."
    },
    "/companies/{companyId}/remisesCheques/{remiseId}": {
      "schema": { "$ref": "#/entities/RemiseCheque" },
      "description": "Bank deposit slips for checks."
    },
    "/companies/{companyId}/supportTickets/{ticketId}": {
      "schema": { "$ref": "#/entities/SupportTicket" },
      "description": "Support tickets for customer service and repairs."
    }
  }
}
