/**
 * @fileoverview Firestore Security Rules for Zenith POS.
 *
 * Core Philosophy:
 * This ruleset enforces a hybrid security model, balancing open access with
 * owner-based restrictions. The primary principle is to ensure data
 * consistency and prevent unauthorized modifications. The application has
 * removed the authentication functionality. Therefore, all rules are set to
 * allow all operations without authentication.
 *
 * Data Structure:
 * - /users/{userId}: Stores individual user profiles.
 * - /companies/{companyId}: Root collection for company-specific data.
 * - Under each /companies/{companyId}:
 *   - /customers/{customerId}: Customer data for the company.
 *   - /categories/{categoryId}: Item categories.
 *   - /items/{itemId}: Sellable items.
 *   - /tables/{tableId}: Restaurant tables.
 *   - /sales/{saleId}: Sales records.
 *   - /paymentMethods/{methodId}: Payment methods.
 *   - /vatRates/{vatId}: VAT rates.
 *   - /heldOrders/{orderId}: Temporarily held orders.
 *
 * Key Security Decisions:
 * - No authentication to consider.
 * - Owner-only writes are impossible because there is no authentication. Therefore, this ruleset allows all reads and writes on all data.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Allows read and write access to user profiles. There is no authentication.
     * @path /users/{userId}
     * @allow (get, list, create, update, delete) Any user can read, create, update, and delete any user document.
     * @deny None.
     * @principle Unrestricted access due to the absence of authentication.
     */
    match /users/{userId} {
      allow get, list: if true;
      allow create, update, delete: if true;
    }

    /**
     * @description Allows read and write access to company data. There is no authentication.
     * @path /companies/{companyId}
     * @allow (get, list, create, update, delete) Any user can read, create, update, and delete any company document.
     * @deny None.
     * @principle Unrestricted access due to the absence of authentication.
     */
    match /companies/{companyId} {
      allow get, list: if true;
      allow create, update, delete: if true;

      /**
       * @description Allows read and write access to customer data for a company. There is no authentication.
       * @path /companies/{companyId}/customers/{customerId}
       * @allow (get, list, create, update, delete) Any user can read, create, update, and delete any customer document.
       * @deny None.
       * @principle Unrestricted access due to the absence of authentication.
       */
      match /customers/{customerId} {
        allow get, list: if true;
        allow create, update, delete: if true;
      }

      /**
       * @description Allows read and write access to item categories for a company. There is no authentication.
       * @path /companies/{companyId}/categories/{categoryId}
       * @allow (get, list, create, update, delete) Any user can read, create, update, and delete any category document.
       * @deny None.
       * @principle Unrestricted access due to the absence of authentication.
       */
      match /categories/{categoryId} {
        allow get, list: if true;
        allow create, update, delete: if true;
      }

      /**
       * @description Allows read and write access to sellable items for a company. There is no authentication.
       * @path /companies/{companyId}/items/{itemId}
       * @allow (get, list, create, update, delete) Any user can read, create, update, and delete any item document.
       * @deny None.
       * @principle Unrestricted access due to the absence of authentication.
       */
      match /items/{itemId} {
        allow get, list: if true;
        allow create, update, delete: if true;
      }

      /**
       * @description Allows read and write access to restaurant tables for a company. There is no authentication.
       * @path /companies/{companyId}/tables/{tableId}
       * @allow (get, list, create, update, delete) Any user can read, create, update, and delete any table document.
       * @deny None.
       * @principle Unrestricted access due to the absence of authentication.
       */
      match /tables/{tableId} {
        allow get, list: if true;
        allow create, update, delete: if true;
      }

      /**
       * @description Allows read and write access to sales records for a company. There is no authentication.
       * @path /companies/{companyId}/sales/{saleId}
       * @allow (get, list, create, update, delete) Any user can read, create, update, and delete any sale document.
       * @deny None.
       * @principle Unrestricted access due to the absence of authentication.
       */
      match /sales/{saleId} {
        allow get, list: if true;
        allow create, update, delete: if true;
      }

      /**
       * @description Allows read and write access to payment methods for a company. There is no authentication.
       * @path /companies/{companyId}/paymentMethods/{methodId}
       * @allow (get, list, create, update, delete) Any user can read, create, update, and delete any payment method document.
       * @deny None.
       * @principle Unrestricted access due to the absence of authentication.
       */
      match /paymentMethods/{methodId} {
        allow get, list: if true;
        allow create, update, delete: if true;
      }

      /**
       * @description Allows read and write access to VAT rates for a company. There is no authentication.
       * @path /companies/{companyId}/vatRates/{vatId}
       * @allow (get, list, create, update, delete) Any user can read, create, update, and delete any vat rate document.
       * @deny None.
       * @principle Unrestricted access due to the absence of authentication.
       */
      match /vatRates/{vatId} {
        allow get, list: if true;
        allow create, update, delete: if true;
      }

      /**
       * @description Allows read and write access to held orders for a company. There is no authentication.
       * @path /companies/{companyId}/heldOrders/{orderId}
       * @allow (get, list, create, update, delete) Any user can read, create, update, and delete any held order document.
       * @deny None.
       * @principle Unrestricted access due to the absence of authentication.
       */
      match /heldOrders/{orderId} {
        allow get, list: if true;
        allow create, update, delete: if true;
      }
    }
  }
}